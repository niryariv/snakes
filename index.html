<!DOCTYPE html>
<html>
<head>
	<title>לכידות נחשים</title>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="apple-mobile-web-app-capable" content="yes" />

	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
 <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
 	<!-- <script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script> -->
 	<script src="Leaflet.MakiMarkers.js"></script>


	<style type="text/css">
		body {
		    padding: 0;
		    margin: 0;
		    background-color: #fff;
		}

		html, body, #map {
		    height: 100%;
		}
	</style>

</head>
<body>
	<div id="map"></div>

	<script
			  src="https://code.jquery.com/jquery-3.2.1.min.js"
			  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
			  crossorigin="anonymous"></script>

	<script type="text/javascript">

		var MAP_CENTER = [32.2, 35.19];
		var DEFAULT_ZOOM = 8;

		L.MakiMarkers.accessToken = "pk.eyJ1IjoibmlyeWFyaXYiLCJhIjoiQjdJeWdqZyJ9.pZOwn6stABGoptmp0DH1wg";
		// var icon = L.MakiMarkers.icon({icon: "golf", color: "#85AFDF", size: "m"});

		var map = L.map('map', { scrollWheelZoom: true }).setView(MAP_CENTER, DEFAULT_ZOOM);

		tile_url = '//{s}.tiles.mapbox.com/v3/niryariv.map-n3zuwkkz/{z}/{x}/{y}.png';
		// tile_url = "http://niryariv.github.io/israel_tiles/{z}/{x}/{y}.png";


		L.tileLayer(tile_url, {
			// maxZoom: 16,
			// minZoom: 9
		}).addTo(map);


		function popupContent(data){
			return(
				"<b>" + data['מספר דיווח'] + "</b>"
			);
		}


		$.getJSON('data/snakes.json', function(data){
			$.each(data, function(k,item){
				if (10265 == item['מספר דיווח']) console.log(item);

				var capture_loc = L.latLng(item.capture_x, item.capture_y);
				var release_loc = L.latLng(item.release_x, item.release_y);

				var capture = L.marker(capture_loc,
								{
									icon: L.MakiMarkers.icon({icon: "golf", color: "#c2403a", size: "s"}),
									riseOnHover: true
								}).on({
										mouseover: function(){L.polyline([capture_loc, release_loc]).addTo(map)}
								});

				var release = L.marker(release_loc,
								{
									icon: L.MakiMarkers.icon({icon: "golf", color: "#85afdf", size: "s"}),
									riseOnHover: true
								}).on({
										mouseover: function(){L.polyline([capture_loc, release_loc]).addTo(map)}
								});
				// var line = L.polyline([capture_loc, release_loc]);
				// line.bindPopup(popupContent(item));


				if (item.capture_x != '' && item.release_x != '') {
					capture.addTo(map);
					release.addTo(map);
					// line.addTo(map);
				}

			})
		})


	</script>
	</body>
</html>
